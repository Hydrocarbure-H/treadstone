# DJ Listenner
## Thomas PEUGNET

# DJ Listenner
> *Nous pouvons penser que tout DJ a d√©j√† √©t√© confront√© au √† la situation suivante :*
> *Une personne s'approche de vous, et vous demande de mettre une musique sp√©cifique. Deux options s'offrent √† vous :
vous poss√©dez la musique dans votre biblioth√®que, et cette derni√®re est reli√©e √† votre logiciel de mixage, ou vous ne la
poss√©dez pas, et √™tes contraints de r√©pondre par la n√©gative.*

Et s'il √©tait possible de faire en sorte que les personnes pr√©sentes lors de votre soir√©e puissent automatiquement
ajouter la musique de leur choix √† votre biblioth√®que ?

C'est ce que nous allons mettre en place dans cet article. Les pr√©requis sont les suivants :

- Un serveur Apache
- PHP v7.1 ou sup√©rieur
- Rsync
- Notre ordinateur pilotant notre platine reli√© au m√™me r√©seau que notre serveur

Nous verrons de fa√ßon superficielle comment cr√©er un serveur apache au vu du nombre de tutoriels disponibles sur
Internet.

# Mise en place du serveur web

## √âtape 1

[Voici un lien](https://www.cherryservers.com/blog/how-to-install-linux-apache-mysql-and-php-lamp-stack-on-ubuntu-20-04#how-to-install-linux-apache-mysql-and-php-lamp-stack-on-ubuntu-2004)
permettant d'effectuer facilement une installation d'apache2 et de PHP.

**Note :** Il n'est pas n√©cessaire d'installer mySQL pour ce projet.

A la fin de l'ex√©cution de toutes les commandes, vous devriez avoir acc√®s √† la page par d√©faut d'Apache.
Si vous avez un nom de domaine, vous pouvez choisir d'ajouter une entr√©e DNS pour rediriger vers votre serveur web.

## √âtape 2

Nous allons maintenant dans notre dossier `/var/www` sur notre serveur, pour y cr√©er un nouveau r√©pertoire du nom de
notre site, sous la forme `dj.\<your domain name\>.com|fr` par exemple.

Nous allons maintenant cr√©er un VirtualHost pour pouvoir rediriger notre trafic vers le dossier que nous venons de cr√©er
√† l'instant. Pour cela, allons nous positionner dans `/etc/apache2/sites-availables/`. C'est ici que sont stock√©s les
fichiers de configurations des sites en lignes.

Nous cr√©ons donc un nouveau fichier du nom de notre site, se terminant en `.conf`.

Vous pouvez utiliser les param√®tres de votre choix, ou copier ceux-ci, inspir√©s des configurations
disponibles [sur ce site](https://httpd.apache.org/docs/2.2/fr/vhosts/examples.html).

```xml
<VirtualHost *:80>

        ServerName dj.your_domain.fr

        DocumentRoot "/var/www/dj.your_domain.fr/src/"

    <Directory /var/www/dj.your_domain.fr/>
        Options FollowSymLinks
        AllowOverride Limit Options FileInfo
        DirectoryIndex index.php
        Order allow,deny
        Allow from all
    </Directory>

</VirtualHost>
```

````python
def test():
    print("Hello World")
````

**Note :** Nous indiquons ici le fichier `index.php` comme destination par d√©faut.

Il est possible d'activer l'HTTPS avec certbot (par exemple), le tutoriel que j'avais suivi est
disponible [ici](https://www.digitalocean.com/community/tutorials/how-to-secure-apache-with-let-s-encrypt-on-ubuntu-20-04).

Pour activer votre site, vous pouvez ex√©cuter les commandes suivantes (en root):

```bash
systemctl enable <your_config_file>
systemctl a2ensite <your_config_file>
systemctl restart apache2
```

Pour finir, il ne reste qu'√† cr√©er le fichier /var/www/dj.your_domain.com/index.php, et mettre une cha√Æne de caract√®res
al√©atoire.

```shell
echo "It works ! :)" > /var/www/dj.your_domain.com/index.php
```

Maintenant, si vous vous rendez sur l'adresse de votre serveur depuis un navigateur, vous devriez tomber sur une page
blanche avec le message que vous venez d'inscrire dans votre fichier php.

# Cr√©ation de l'interface web

## Choix de l'utilisateur

> Il s'agit maintenant d'avoir une interface web facilement utilisable, un minimum ergonomique. Ce dernier aspect est
> d'autant plus important au vu de l'√©tat potentiel d'√©bri√©t√© dans lequel pourraient se trouver certains utilisateurs.

Nous souhaitons que les utilisateurs puissent proposer une musique facilement, mais que cette derni√®re soit de fa√ßon
certaine celle de leur choix (conflit potentiel au niveau du titre).
Deux options se proposent donc √† nous :
> Les utilisateurs rentrent le titre d'une musique, avec √©ventuellement un champ pour renseigner l'artiste √† l'origine
> de la chanson choisie.

- üö´ **Inconv√©nients**
    - N√©cessite l'utilisation de l'API de Youtube, demandant un temps potentiellement consid√©rable
    - Potentiels conflits au niveau du titre (si l'artiste n'est pas demand√©)
    - N√©cessite une validation de l'utilisateur pour v√©rifier qu'il s'agit bien de la musique qu'il a dans son esprit
    - Qu'en est-il d'un titre mal orthographi√©, ou n'√©tant pas renseign√© sur Youtube mais sur Spotify, par exemple ?
- ‚úÖ **Avantages**
    - Ergonomie (saisie d'un nom d'artiste/d'un titre)

> Les utilisateurs remplissent un champ URL, redirigeant vers la vid√©o de leur choix.

- üö´ **Inconv√©nient**
    - Ergonomie : L'utilisateur doit s√©lectionner l'URL de la vid√©o, puis la copier dans notre application
- ‚úÖ **Avantages**
    - Pas de possibilit√© de se tromper, hormis pour une erreur de copier-coller
    - Aucune validation n√©cessaire
    - Rapide √† mettre en place (requ√™te sur une page youtube et v√©rification du code de retour)

Nous allons donc nous tourner vers l'option num√©ro deux.